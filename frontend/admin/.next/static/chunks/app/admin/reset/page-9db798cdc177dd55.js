(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[431],{4685:function(t,e,n){Promise.resolve().then(n.bind(n,3126))},3126:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return l}});var o=n(7437),a=n(6463),r=n(2265),s=n(7973),i=n(6264);function l(){let t=(0,a.useSearchParams)(),e=(0,a.useRouter)(),n=t.get("token")||"",[l,c]=(0,r.useState)(""),[u,d]=(0,r.useState)(""),[h,f]=(0,r.useState)(!1),[p,m]=(0,r.useState)(null),[v,w]=(0,r.useState)(null),y=async t=>{if(t.preventDefault(),m(null),w(null),!n){m("Chyb\xed token pro reset hesla.");return}f(!0);try{await (0,i.c0)({token:n,password:l,password2:u}),w("Heslo bylo nastaveno. Můžeš se přihl\xe1sit."),setTimeout(()=>e.push("/admin/login"),1200)}catch(t){m(t instanceof Error?t.message:"Reset hesla selhal.")}finally{f(!1)}};return(0,o.jsx)("div",{className:"flex min-h-screen items-center justify-center px-4 py-10",children:(0,o.jsxs)("div",{className:"w-full max-w-lg rounded-2xl bg-white p-8 shadow-xl",children:[(0,o.jsx)("h1",{className:"mb-4 text-xl font-semibold",children:"Nastavit nov\xe9 heslo"}),(p||v)&&(0,o.jsxs)("div",{className:"mb-4 space-y-2",children:[p&&(0,o.jsx)(s.F,{message:p,tone:"error",onClose:()=>m(null)}),v&&(0,o.jsx)(s.F,{message:v,tone:"success",onClose:()=>w(null)})]}),(0,o.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"password",className:"mb-1 block text-sm font-medium text-gray-700",children:"Nov\xe9 heslo"}),(0,o.jsx)("input",{id:"password",name:"password",type:"password",minLength:6,required:!0,autoComplete:"new-password",value:l,onChange:t=>c(t.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 text-sm focus:border-blue-500 focus:outline-none"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{htmlFor:"password2",className:"mb-1 block text-sm font-medium text-gray-700",children:"Potvrzen\xed hesla"}),(0,o.jsx)("input",{id:"password2",name:"password2",type:"password",minLength:6,required:!0,autoComplete:"new-password",value:u,onChange:t=>d(t.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 text-sm focus:border-blue-500 focus:outline-none"})]}),(0,o.jsx)("button",{type:"submit",disabled:h,className:"w-full rounded-xl bg-emerald-600 px-4 py-3 text-sm font-semibold text-white transition hover:bg-emerald-700 disabled:opacity-60",children:h?"Ukl\xe1d\xe1m…":"Uložit heslo"})]}),(0,o.jsx)("div",{className:"mt-4 text-center text-sm text-gray-600",children:(0,o.jsx)("a",{href:"/admin/forgot",className:"text-blue-600 hover:text-blue-700",children:"← Zpět na obnovu"})})]})})}},7973:function(t,e,n){"use strict";n.d(e,{F:function(){return r}});var o=n(7437);let a={success:"bg-emerald-600",error:"bg-red-600",info:"bg-blue-600"};function r(t){let{message:e,tone:n="info",onClose:r}=t;return(0,o.jsxs)("div",{className:"flex items-start gap-3 rounded-lg px-4 py-3 text-sm text-white shadow-lg ".concat(a[n]),children:[(0,o.jsx)("span",{className:"flex-1",children:e}),r&&(0,o.jsx)("button",{type:"button",onClick:r,className:"text-white/80 hover:text-white",children:"✕"})]})}},6264:function(t,e,n){"use strict";n.d(e,{$Y:function(){return S},Bd:function(){return O},Dj:function(){return y},Hy:function(){return E},Ir:function(){return m},MX:function(){return i},QX:function(){return T},RA:function(){return v},SN:function(){return P},TE:function(){return w},c0:function(){return k},cQ:function(){return N},cW:function(){return b},f8:function(){return r},gF:function(){return x},h6:function(){return j},jn:function(){return l},k4:function(){return u},nM:function(){return p},pE:function(){return c},ry:function(){return f},t2:function(){return s},uu:function(){return h},yr:function(){return d},zm:function(){return g}});let o="/api",a=o.includes("backend")?"/api":o;function r(t){let e=t.startsWith("/")?t:"/".concat(t);return"/api"===a?e.startsWith("/api/")||"/api"===e?e:"/api".concat(e):"".concat(a).concat(e)}async function s(){let t=await fetch(r("/api/products/"),{cache:"no-store"});if(!t.ok)throw Error("Nepodařilo se nač\xedst produkty (".concat(t.status,")"));return await t.json()}async function i(t){let e=await fetch(r("/api/products/".concat(t)),{cache:"no-store"});if(!e.ok)throw Error("Nepodařilo se nač\xedst produkt (".concat(e.status,")"));return await e.json()}async function l(t){let e=await fetch(r("/api/categories/".concat(t)),{cache:"no-store"});if(!e.ok)throw Error("Nepodařilo se nač\xedst kategorii (".concat(e.status,")"));return await e.json()}async function c(){let t=await fetch(r("/api/categories/"),{cache:"no-store"});if(!t.ok)throw Error("Nepodařilo se nač\xedst kategorie (".concat(t.status,")"));return await t.json()}async function u(t){let e=await fetch(r("/api/categories/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){let t="Nepodařilo se vytvořit kategorii (".concat(e.status,")");try{let n=await e.json();t=(null==n?void 0:n.error)||(null==n?void 0:n.message)||(null==n?void 0:n.detail)||t}catch(t){}throw Error(t)}return await e.json()}async function d(t,e){let n=await fetch(r("/api/categories/".concat(t)),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!n.ok){let t="Nepodařilo se uložit kategorii (".concat(n.status,")");try{let e=await n.json();t=(null==e?void 0:e.error)||(null==e?void 0:e.message)||(null==e?void 0:e.detail)||t}catch(t){}throw Error(t)}return await n.json()}async function h(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=await fetch(r(e?"/api/categories/".concat(t,"?force=true"):"/api/categories/".concat(t)),{method:"DELETE"});if(!n.ok){let t="Nepodařilo se smazat kategorii (".concat(n.status,")");try{let e=await n.json();t=(null==e?void 0:e.error)||(null==e?void 0:e.message)||(null==e?void 0:e.detail)||t}catch(t){}throw Error(t)}}async function f(t){let e=await fetch(r("/api/products/"),{method:"POST",body:t});if(!e.ok){let t="Nepodařilo se vytvořit produkt (".concat(e.status,")");try{let n=await e.json();t=(null==n?void 0:n.error)||(null==n?void 0:n.message)||(null==n?void 0:n.detail)||t}catch(t){}throw Error(t)}return await e.json()}async function p(t,e){let n=await fetch(r("/api/products/".concat(t)),{method:"PUT",body:e});if(!n.ok){let t="Nepodařilo se uložit produkt (".concat(n.status,")");try{let e=await n.json();t=(null==e?void 0:e.error)||(null==e?void 0:e.message)||(null==e?void 0:e.detail)||t}catch(t){}throw Error(t)}return await n.json()}async function m(t){let e=await fetch(r("/api/products/".concat(t)),{method:"DELETE"});if(!e.ok){let t="Nepodařilo se smazat produkt (".concat(e.status,")");try{let n=await e.json();t=(null==n?void 0:n.error)||(null==n?void 0:n.message)||(null==n?void 0:n.detail)||t}catch(t){}throw Error(t)}}async function v(t){let e=await fetch(r("/api/ai/vision/analyze"),{method:"POST",body:t});if(!e.ok){let t="Anal\xfdza obr\xe1zku selhala (".concat(e.status,")");try{let n=await e.json();t=(null==n?void 0:n.error)||(null==n?void 0:n.message)||(null==n?void 0:n.detail)||t}catch(t){}throw Error(t)}return await e.json()}async function w(t){let e=await fetch(r("/api/ai/deepseek/generate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({context:t})});if(!e.ok){let t="Generov\xe1n\xed popisu selhalo (".concat(e.status,")");try{let n=await e.json();t=(null==n?void 0:n.error)||(null==n?void 0:n.message)||(null==n?void 0:n.detail)||t}catch(t){}throw Error(t)}return await e.json()}async function y(t){await fetch(r("/api/ai/rag/ingest"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}async function g(t){let e=await fetch(r("/api/ai/rag/search"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){let t="Vyhled\xe1v\xe1n\xed v RAG selhalo (".concat(e.status,")");try{let n=await e.json();t=(null==n?void 0:n.error)||(null==n?void 0:n.message)||(null==n?void 0:n.detail)||t}catch(t){}throw Error(t)}return e.json()}async function j(t){let e=await fetch(r("/api/media/".concat(t)),{method:"DELETE"});if(!e.ok){let t="Smaz\xe1n\xed m\xe9dia selhalo (".concat(e.status,")");try{let n=await e.json();t=(null==n?void 0:n.error)||(null==n?void 0:n.message)||(null==n?void 0:n.detail)||t}catch(t){}throw Error(t)}}async function b(t){let e=await fetch(r("/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){let t="Přihl\xe1šen\xed selhalo (".concat(e.status,")");try{let n=await e.json();t=(null==n?void 0:n.error)||(null==n?void 0:n.message)||(null==n?void 0:n.detail)||t}catch(t){}throw Error(t)}}async function x(t){let e=await fetch(r("/api/auth/forgot"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){let t="Odesl\xe1n\xed odkazu selhalo (".concat(e.status,")");try{let n=await e.json();t=(null==n?void 0:n.error)||(null==n?void 0:n.message)||(null==n?void 0:n.detail)||t}catch(t){}throw Error(t)}}async function k(t){let e=await fetch(r("/api/auth/reset"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!e.ok){let t="Reset hesla selhal (".concat(e.status,")");try{let n=await e.json();t=(null==n?void 0:n.error)||(null==n?void 0:n.message)||(null==n?void 0:n.detail)||t}catch(t){}throw Error(t)}}async function N(t){var e,n,o,a;let s=new URLSearchParams;t.vs&&s.set("vs",t.vs),t.status&&"all"!==t.status&&s.set("status",t.status),t.limit&&s.set("per_page",String(t.limit));let i=await fetch(r("/api/payments?".concat(s.toString())),{cache:"no-store"});if(!i.ok)throw Error("Nepodařilo se nač\xedst platby (".concat(i.status,")"));let l=await i.json();return{items:(null==l?void 0:l.items)||(null==l?void 0:l.rows)||(null==l?void 0:l.data)||[],total:null!==(n=null!==(e=null==l?void 0:l.total)&&void 0!==e?e:null==l?void 0:l.count)&&void 0!==n?n:null,page:null!==(o=null==l?void 0:l.page)&&void 0!==o?o:null,per_page:null!==(a=null==l?void 0:l.per_page)&&void 0!==a?a:null}}async function E(){var t,e,n;let o=await fetch(r("/api/payments/summary"),{cache:"no-store"});if(!o.ok)return null;let a=await o.json();return{count:null!==(t=null==a?void 0:a.count)&&void 0!==t?t:null,total_amount:null!==(n=null!==(e=null==a?void 0:a.total_amount)&&void 0!==e?e:null==a?void 0:a.totalAmount)&&void 0!==n?n:null}}async function S(t){let e=new URLSearchParams;Object.entries(t).forEach(t=>{let[n,o]=t;o&&e.set(n,o)});let n=await fetch(r("/api/sold?".concat(e.toString())),{cache:"no-store"});if(!n.ok)throw Error("Nepodařilo se nač\xedst prodan\xe9 (".concat(n.status,")"));let o=await n.json();return{rows:(null==o?void 0:o.rows)||(null==o?void 0:o.items)||(null==o?void 0:o.data)||[],summary:(null==o?void 0:o.summary)||null}}function P(t,e){let n=new URLSearchParams;return Object.entries(e).forEach(t=>{let[e,o]=t;o&&n.set(e,o)}),r("/api/sold/export/".concat(t,"?").concat(n.toString()))}function T(t){return r("/api/sold/".concat(t,"/invoice-preview"))}async function O(t){let e=await fetch(r("/api/sold/".concat(t,"/invoice-send")),{method:"POST"});if(!e.ok){let t="Odesl\xe1n\xed faktury selhalo (".concat(e.status,")");try{let n=await e.json();t=(null==n?void 0:n.error)||(null==n?void 0:n.message)||(null==n?void 0:n.detail)||t}catch(t){}throw Error(t)}}},6463:function(t,e,n){"use strict";var o=n(1169);n.o(o,"useParams")&&n.d(e,{useParams:function(){return o.useParams}}),n.o(o,"usePathname")&&n.d(e,{usePathname:function(){return o.usePathname}}),n.o(o,"useRouter")&&n.d(e,{useRouter:function(){return o.useRouter}}),n.o(o,"useSearchParams")&&n.d(e,{useSearchParams:function(){return o.useSearchParams}})}},function(t){t.O(0,[971,23,744],function(){return t(t.s=4685)}),_N_E=t.O()}]);